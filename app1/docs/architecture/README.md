# Project Architecture

----

## Stack

### Environment tools

- [Unix shell](https://en.wikipedia.org/wiki/Unix_shell)
- [Git](https://git-scm.com)
- [Atom](http://atom.io)
- [Chrome Dev Tools](https://developers.google.com/web/tools/chrome-devtools/)

### Platforms

- [Node](http://nodejs.org) v4+
- Ever green browsers and IE11

### Languages

- [ES2015](https://en.wikipedia.org/wiki/ECMAScript)
- [JSX](https://jsx.github.io)
- [SASS](http://sass-lang.com)

### Tools

- [Express](http://expressjs.com) - Server
- [React](https://facebook.github.io/react/) - JS view library
- [Redux](http://redux.js.org) - Predictable state container for JS apps
- [Immutable](https://facebook.github.io/immutable-js/) - Immutable collections for JS
- [jQuery](http://jquery.com) - General JS library
- [Foundation](http://foundation.zurb.com/docs/) - Responsive frontend framework
- [Material Design Icons](http://materialdesignicons.com) - Icons

### Tasks and automation

- [Gulp](http://gulpjs.com) - Tasks runner
- [Webpack](http://webpack.github.io/) - JS module manager
- [Bower](http://bower.io) - Libraries manager
- [Hologram](http://trulia.github.io/hologram/) - Design system generator
- [Mocha](http://mochajs.org) - Test runner
- [Karma](http://karma-runner.github.io) - Testing environment
- [Enzyme](http://airbnb.io/enzyme) - JS test utility for React

----

## Methodologies

- [Functional programming](https://en.wikipedia.org/wiki/Functional_programming)
- [Behavior-driven development](https://en.wikipedia.org/wiki/Behavior-driven_development)
- [FIRST](https://addyosmani.com/first)
- [CommonJS](http://commonjs.org)
- [Atomic design](http://atomicdesign.bradfrost.com)
- [BEM](https://en.bem.info)
- [JS Style Guide](https://github.com/airbnb/javascript)
- [CSS Style Guide](https://github.com/airbnb/css)

### General rules and conventions

- Codification UTF-8
- 2 space indentation
- File names, lowercase, words split by dashes

### Design

- **General**:
  - Use `box-sizing` with `border-box`.
  - Use `rem` for font sizes. Pixels for everything else.
- **Layouts**:
  - A layout is only concerned with its children horizontal or vertical alignment and spacing. Layouts can have only margin bottom.
- **Components**:
  - A component never imposes element styles on its children.
  - Component styles only target the elements inside.
  - The component itself never has floats or margins. It should not have background nor width/height.
- **Elements**:
  - Every element has a single, unique, component-scoped class. All styles are applied directly to that selector, modified only by contexts and themes.
  - Themes and other data attributes never force changes in appearance; they are always a context that layouts, components, and elements can subscribe to.
  - No element will have top or left margins, they could have right or bottom margins and all last children will have their margins cleared. The first element touches the top of its component.

Some rules from [Frontend Architecture for design systems](http://shop.oreilly.com/product/0636920040156.do).

### Code

- Variables names, camel case
- All require modules must be placed at the beginning

----

## Budget

- All public facing content should be crawlable at page load
- Public pages should weight less than 3MB on initial load
- Public pages should load first content in less than 2 seconds through _Regular 4G_ connection

----

## Structure

### General

We use [npm scripts](https://docs.npmjs.com/misc/scripts) as API to our project.

- `node_modules/` - Server and universal modules
- `bower_components/` - Client libraries
- `package.json` - Server conf
- `bower.json` - Bower conf
- `gulpfile.js` - Gulp conf
- `webpack.base.js` - WebPack base conf
- `webpack.config.js` - WebPack conf
- `karma.conf.js` - Karma conf
- `hologram_config.yml` - Hologram conf
- `.editorconfig` - Editor conf
- `.jshintrc` - JSHint conf
- `.babelrc` - Babel conf
- `.gitignore`
- `.gitattributes`

### Project

We store the general project configuration at `package.json`.

Separate client and server side code in different locations. If there is code used universally, we place it in the client folder. Also, there are docs, automation tasks, executables, tests, and a client side distribution folder for public access.

We don't organize the files by isolated client components. We distribute them by category: **functional** `src/js/`, **design** `src/scss/`, **resources** `dist/` and **tests** `test/`. Possible resources source should be in `src/[RESOURCE]/`.

A page can be static or an SPA. If static, the entire page will be generated in server side with universal components. If SPA, most of the page will be generated by dynamic client JS, but can render from server.

The client source will be used to generate distribution files without nested folders. Example: `src/js/app1/app1.js` should generate `dist/js/app1.js`.

- `docs/` - Documentation
  - `spec/` - Specification
  - `architecture/` - Architecture and design
  - `styleguide/` - Style design system
  - `sass/` - SASS docs
  - `js/` - Universal API docs
  - `api/` - Server API docs
  - *`user/` - User documentation*
- `tasks/` - Automated tasks conf
- `bin/` - Executables
  - `server.js` - Server
- `api/` - Server API
  - `models/` - Data models
  - `urls/` - Endpoints
  - `log.js` - Logger
- `views/` - Server JSX templates
- *`lib/` - Client static libraries*
  - *`js/`*
  - *`css/`*
- `src/` - Source code (universal, client and server)
  - `js/`
    - *`tools/` - General tools*
    - *`i18n/` - Internationalization*
    - *`data/` - Data utils*
    - `components/` - React components
    - `core/` - Core utils
      - `analytics.js`
      - `core.js`
    - `[application]/` - Application template
      - `containers/` - React container components
      - *`data/`*
      - *`actions/`*
      - *`reducers/`*
      - *`stores/`*
      - *`routers.js`*
      - *`constants.js`*
      - `render.js`
      - *`[application]-server.js` - Server page generator*
      - `[application].js` - Client SPA script
    - `settings.js` - Client side conf
  - `scss/`
    - `components/` - React components styles
    - *`tools/` - SASS utils*
    - `core/` - Core styles
      - `core.scss`
    - `[application]/` - Application template
      - `[application].scss`
    - `_settings.scss`
- `dist/` - Client assets and built client code (the public folder)
  - `files/` - Dynamic files by users
  - `css/`
  - `js/`
  - `img/`
  - `fonts/`
  - `audio/`
  - `video/`
- `test/` - Universal tests
  - `integration/`
  - `tools/`
  - `components/`
  - `[application]/`
